#compdef mpt
#autoload

# in order to make this work, you will need to have mpt

# mpt (mobile-pentest-toolkit) zsh completion, based on homebrew completion

local -a _1st_arguments
_1st_arguments=(
'--setup:[APK] setup pentest environment'
'--help:show print message and exit'
'--install:install required packages [tools|apps]'
'--list-packages:show all installed packages (use option 'all' to display system apps)'
'--adb-run:start adb server'
'--pidcat:[package-name] show colored logcat for a specific application'
'--backup:[package-name] backup an android application'
'--source:start java decompiler for source code analysis'
'--frida:run frida server on the device'
'--inspeckage:open Inspeckage web interface'
'--mobile-sec-framework:run Mobile Security Framework (MobSF)'
'--drozer:run drozer application'
'--ssl-pinning:[package-name]disable SSL pinning (<package name> optional)'
'--root-detection:[package-name]disable root detection (<package name> optional)'
)

local expl
local -a pkgs installed_pkgs

_arguments \
	'*:: :->subcmds' && return 0


if (( CURRENT == 1 )); then
	_describe -t commands "mpt subcommand" _1st_arguments
	return
fi

_files